(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{159:function(e,a,t){"use strict";t.r(a);t(76);var n=t(0),r=t.n(n),c=t(17),l=t.n(c),o=(t(81),t(82),t(19)),i=t(23),s=t.n(i),m=t(28),u=t(9),d=t(39),E=t.n(d),p=t(71),f=t.n(p),g=t(22),v=t(38),b=t.n(v),h=t(24),O=t.n(h);function N(e){return r.a.createElement(O.a,{show:e.show,onHide:e.onHide},r.a.createElement(O.a.Header,{closeButton:!0},r.a.createElement(O.a.Title,null,"Esc\xe1ner de partituras manuscritas")),r.a.createElement(O.a.Body,null,r.a.createElement("h5",null,"Informaci\xf3n del proyecto"),r.a.createElement("p",{className:"text-justify"},"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed consectetur quis leo eu cursus. Curabitur sit amet augue nec sapien posuere sodales. Aenean at egestas massa, sed hendrerit libero. Sed malesuada imperdiet purus, sed commodo leo fermentum at. Suspendisse vehicula rutrum dolor. Quisque posuere ipsum elit, et volutpat ligula volutpat posuere. Fusce pulvinar eros vel purus congue, non hendrerit arcu hendrerit. Vestibulum id vestibulum nulla. Proin quam orci, dictum eleifend nunc in, sodales maximus turpis. Nullam pretium sit amet tellus ac facilisis. Donec in felis ligula. Fusce vestibulum lorem vitae lectus pharetra interdum. Etiam sed pharetra quam."),r.a.createElement("h5",null,"Instrucciones de uso"),r.a.createElement("p",{className:"text-justify"},"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed consectetur quis leo eu cursus. Curabitur sit amet augue nec sapien posuere sodales. Aenean at egestas massa, sed hendrerit libero. Sed malesuada imperdiet purus, sed commodo leo fermentum at. Suspendisse vehicula rutrum dolor. Quisque posuere ipsum elit, et volutpat ligula volutpat posuere. Fusce pulvinar eros vel purus congue, non hendrerit arcu hendrerit. Vestibulum id vestibulum nulla. Proin quam orci, dictum eleifend nunc in, sodales maximus turpis. Nullam pretium sit amet tellus ac facilisis. Donec in felis ligula. Fusce vestibulum lorem vitae lectus pharetra interdum. Etiam sed pharetra quam.")))}function y(e){var a=Object(n.useState)(!1),t=Object(u.a)(a,2),c=t[0],l=t[1];return r.a.createElement("header",{className:"w-100 my-0"},r.a.createElement(N,{show:c,onHide:function(){return l(!1)}}),e.small?r.a.createElement(E.a,{variant:"light",bg:"white",className:"pt-1 pb-0 px-0"},r.a.createElement(m.LinkContainer,{to:"/"},r.a.createElement(E.a.Brand,null,r.a.createElement("img",{alt:"HISPAMUS",src:b.a,height:"25",className:"d-inline-block"}))),r.a.createElement(f.a,{className:"ml-auto"},r.a.createElement(s.a,{variant:"link",onClick:function(){return l(!0)}},r.a.createElement("i",{className:"fas fa-info-circle fa-2x"})))):r.a.createElement("div",{className:"row my-3"},r.a.createElement("div",{className:"col-9"},r.a.createElement(g.Link,{to:"/"},r.a.createElement("img",{className:"img-fluid",src:b.a,alt:"Logo"}))),r.a.createElement("div",{className:"col-3 d-flex justify-content-end align-items-center"},r.a.createElement(s.a,{variant:"link",onClick:function(){return l(!0)}},r.a.createElement("i",{className:"fas fa-info-circle fa-2x info-blink"})))))}function w(){return r.a.createElement("footer",{className:"w-100 mt-3 text-center border-top pt-3"},r.a.createElement("p",null,r.a.createElement("a",{href:"https://grfia.dlsi.ua.es",className:"text-dark"},"\xa9 GRFIA - Universidad de Alicante")))}function R(){return r.a.createElement("div",null,r.a.createElement(y,null),r.a.createElement("div",{className:"row px-3"},r.a.createElement("h4",null,"Esc\xe1ner de partituras manuscritas")),r.a.createElement("div",{className:"row mt-3"},r.a.createElement("div",{className:"col-12"},r.a.createElement(m.LinkContainer,{to:"/scan"},r.a.createElement(s.a,{variant:"primary",size:"lg",block:!0},r.a.createElement("i",{className:"fas fa-scroll"}),"\xa0Copiar una partitura")))),r.a.createElement(w,null))}var x=t(18);function A(){return r.a.createElement("div",{className:"w-100 mt-2"},r.a.createElement("div",{className:"d-flex flex-column flex-sm-row justify-content-sm-end"},r.a.createElement("div",{className:"d-inline-block mb-3 mx-sm-1 skeleton",style:{minWidth:"15ex"}},"\xa0"),r.a.createElement("div",{className:"d-inline-block mb-3 mx-sm-1 skeleton",style:{minWidth:"15ex"}},"\xa0")),r.a.createElement("div",{className:"d-block mr-3 skeleton",style:{width:"25ex"}},"\xa0"),r.a.createElement("div",{className:"d-block w-100 mt-4 skeleton",style:{height:"100px"}},"\xa0"))}function D(e){return r.a.createElement("div",{className:"w-100 my-3"},r.a.createElement("div",{className:"alert alert-".concat(e.variant),role:"alert"},e.text),r.a.createElement("button",{className:"btn btn-primary w-100",onClick:e.onReset},"Volver a empezar"))}function k(e){var a=Object(n.useState)(!1),t=Object(u.a)(a,2),c=t[0],l=t[1],o=r.a.createRef();function i(){l(!c)}return r.a.createElement("div",{className:"w-100 mt-2"},r.a.createElement("div",{className:"d-flex flex-column flex-sm-row justify-content-sm-end"},r.a.createElement("button",{className:"btn btn-primary mb-3 mx-1",onClick:e.onReset},r.a.createElement("i",{className:"fas fa-sync"})," Cargar otra"),r.a.createElement("label",{className:"btn btn-primary mb-3 mx-1",htmlFor:"inputImage",title:"Escanear"},r.a.createElement("input",{type:"file",id:"inputImage",className:"sr-only",name:"file",accept:"image/*",ref:o,onChange:function(){o.current.files&&o.current.files.length>0&&e.onSelect(o.current.files[0])}}),r.a.createElement("i",{className:"fas fa-camera"})," Escanear versi\xf3n manuscrita")),r.a.createElement("h5",null,e.score.title," (",e.score.author,")"),r.a.createElement("div",{className:"overflow-auto mt-3",style:{transform:"rotate(0)"}},r.a.createElement("div",{className:"d-inline-block"},r.a.createElement("button",{className:"btn btn-link text-dark",onClick:i},r.a.createElement("i",{className:"fas fa-search-"+(c?"minus":"plus")}))),r.a.createElement("img",{className:c?"":"img-fluid",alt:"score",src:"data:image/png;base64,".concat(e.score.png),onClick:i})))}var I=t(72),j=t.n(I);t(138);function _(e){var a=Object(n.useState)(void 0),t=Object(u.a)(a,2),c=t[0],l=t[1],o=Object(n.useState)({x:10,y:10,width:100,height:100}),i=Object(u.a)(o,2),s=i[0],m=i[1];function d(a){var t=new FileReader;t.onloadend=function(){var a=t.result;e.onUpload(a)},t.readAsDataURL(a)}return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"w-100 mt-3"},r.a.createElement("button",{className:"btn btn-primary btn-block mb-3",onClick:function(){if(c){var e=document.createElement("canvas"),a=c.naturalWidth/c.width,t=c.naturalHeight/c.height,n=s.width*a,r=s.height*t;e.width=n,e.height=r,e.getContext("2d").drawImage(c,s.x*a,s.y*t,n,r,0,0,n,r),e.toBlob(d,"image/png")}}},"Enviar"),r.a.createElement(j.a,{src:e.image,crop:s,onImageLoaded:function(e,a){return l(e)},onChange:function(e){m(e)},alt:"imagen"})))}var L=t(74),C=t.n(L),S=t(73),U=t.n(S),P="/copymus/api/scanner/random/primus",G="/copymus/api/scanner/upload";function F(e){var a=Object(n.useState)(25),t=Object(u.a)(a,2),c=t[0],l=t[1],o=Object(n.useState)({image:e.image,score:e.score,onUpload:e.onUpload,onError:e.onError}),i=Object(u.a)(o,1)[0];return Object(n.useEffect)(function(){var e={png:i.image.replace("data:image/png;base64,",""),id:i.score.id,db:i.score.db};U.a.post(G,e,{headers:{"Content-Type":"application/json"},onUploadProgress:function(e){l(25+e.loaded/e.total*75)}}).then(function(e){i.onUpload()}).catch(function(e){i.onError()})},[i]),r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{animated:!0,now:c,className:"my-3"}),r.a.createElement("img",{src:e.image,alt:"",className:"img-fluid d-block mx-auto"}))}var M={LOADING_SCORE:"loading_score",LOAD_ERROR:"load_error",LOADED_SCORE:"loaded_score",LOADED_IMAGE:"loaded_image",CROPPED_IMAGE:"cropped_image",UPLOAD_ERROR:"upload_error",UPLOADED_IMAGE:"uploaded_image",RESET:"reset"},q={loading:!1,error:!1,score:void 0,selectedImage:void 0,croppedImage:void 0,finished:!1};function H(e,a){switch(a.type){case M.LOADING_SCORE:return Object(x.a)({},e,{loading:!0});case M.LOAD_ERROR:return Object(x.a)({},e,{loading:!0,error:!0});case M.LOADED_SCORE:return Object(x.a)({},e,{loading:!1,error:!1,score:a.payload});case M.LOADED_IMAGE:return Object(x.a)({},e,{selectedImage:a.payload});case M.CROPPED_IMAGE:return Object(x.a)({},e,{croppedImage:a.payload});case M.UPLOAD_ERROR:return Object(x.a)({},e,{error:!0});case M.UPLOADED_IMAGE:return Object(x.a)({},q,{finished:!0});case M.RESET:return q;default:throw new Error}}function B(){var e=Object(n.useReducer)(H,q),a=Object(u.a)(e,2),t=a[0],c=a[1];function l(){c({type:M.RESET}),o()}function o(){c({type:M.LOADING_SCORE}),fetch(P).then(function(e){if(200===e.status)return e.json();throw new Error("No se puede contactar con el servidor")}).then(function(e){c({type:M.LOADED_SCORE,payload:e})}).catch(function(e){c({type:M.LOAD_ERROR}),console.error(e)})}return Object(n.useEffect)(function(){o()},[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(y,{small:!0}),t.loading&&!t.error&&r.a.createElement(A,null),t.loading&&t.error&&r.a.createElement(D,{variant:"danger",text:"Ha ocurrido un error al cargar la imagen",onReset:l}),t.score&&!t.selectedImage&&r.a.createElement(k,{score:t.score,onSelect:function(e){var a=new FileReader;a.onload=function(){c({type:M.LOADED_IMAGE,payload:a.result})},a.readAsDataURL(e)},onReset:l}),t.selectedImage&&!t.croppedImage&&r.a.createElement(_,{image:t.selectedImage,onUpload:function(e){c({type:M.CROPPED_IMAGE,payload:e})}}),t.croppedImage&&!t.error&&r.a.createElement(F,{image:t.croppedImage,score:t.score,onUpload:function(){return c({type:M.UPLOADED_IMAGE})},onError:function(){return c({type:M.UPLOAD_ERROR})}}),t.croppedImage&&t.error&&r.a.createElement(D,{variant:"danger",text:"Ha ocurrido un error al enviar la imagen",onReset:l}),t.finished&&r.a.createElement(D,{variant:"success",text:"\xa1Gracias por colaborar!",onReset:l}),r.a.createElement(w,null))}var T=function(){return r.a.createElement(o.a,null,r.a.createElement("div",{className:"container-fluid"},r.a.createElement(o.g,null,r.a.createElement(o.d,{exact:!0,path:"/",component:R}),r.a.createElement(o.d,{exact:!0,path:"/scan",component:B}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},38:function(e,a,t){e.exports=t.p+"static/media/logo.cfbdceaa.png"},75:function(e,a,t){e.exports=t(159)},81:function(e,a,t){},82:function(e,a,t){}},[[75,1,2]]]);
//# sourceMappingURL=main.a5d22423.chunk.js.map